<!-- Content Header (Page header) -->
    <!-- 头部信息 -->
	<section class="content-header">
      <h1>
        集群汇总信息
        <small>资源使用率</small>
      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> 首页</a></li>
        <li><a href="#">汇总</a></li>
      </ol>
    </section>
	<!-- 头部结束 -->
<!-- Main content -->
<section class="content container-fluid">
    <!-- 页面内容开始 -->

<section class="content">
	<hr></hr>
	<div class="row">
		<div class="col-md-3" style="box-shadow: 10px 10px 5px #888888;">
				<span style="font-size:10px;font-weight:bold;">集群规模:</span>
				<span id="nodenum" style="font-size:26px;color:green">0</span>
				<span style="font-size:16px;">台</span>
		</div>
		
		<div class="col-md-3" style="box-shadow: 10px 10px 5px #888888;">
				<span style="font-size:10px;font-weight:bold;">运行POD数量:</span>
				<span id="podnum" style="font-size:26px;color:green">0</span>
				<span style="font-size:16px;">个</span>
		</div>
		
		<div class="col-md-3" style="box-shadow: 10px 10px 5px #888888;">
				<span style="font-size:10px;font-weight:bold;">传入流量:</span>
				<span id="netin" style="font-size:26px;color:green">0</span>
				<span style="font-size:16px;">KB/S</span>
		</div>
		
		<div class="col-md-3" style="box-shadow: 10px 10px 5px #888888;">
				<span style="font-size:10px;font-weight:bold;">传出流量:</span>
				<span id="netout" style="font-size:26px;color:green">0</span>
				<span style="font-size:16px;">KB/S</span>
		</div>
	</div>
		
	<div class="row">
        <div class="col-md-12">
			<div id="main_cpu_men_disk" style="width: 100%;height:450px;"></div>
        </div>
	</div>

	<div class="row" style="box-shadow: 10px 10px 5px #888888;">
        <div class="col-md-6">
			<div id="main_public" style="width: 100%;height:380px;"></div>
        </div>

    </div>
</section>

<!-- 加载图表显示 -->
<script src="/static/plugins/echarts/echarts.min.js"></script>
<!-- 表格插件  -->
<script src="/static/plugins/bootstrap-table/bootstrap-table.js" type="text/javascript"></script>
<script src="/static/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js" type="text/javascript"></script>
<script src="/static/plugins/bootstrap-table/cookie/bootstrap-table-cookie.js"></script>
<link rel="stylesheet" href="/static/plugins/bootstrap-table/bootstrap-table.min.css">
<script>


        // 基于准备好的dom，初始化实例
		
		//zxbk_cpu_men_disk_chart 开始---------------------
        var zxbk_cpu_men_disk_chart = echarts.init(document.getElementById('main_cpu_men_disk'));
		//显示加载缓冲
		//zxbk_cpu_men_disk_chart.showLoading();
        // 指定图表的配置项和数据
		var zxbk_cpu_men_disk_chart_option = {
			tooltip : {
				formatter: "{a} <br/>{c} {b}"
			},
			/*toolbox: {
				show: true,
				feature: {
					restore: {show: true},
					saveAsImage: {show: true}
				}
			},*/
			series : [
				{
					name: 'CPU',
					type: 'gauge',
					z: 3,
					min: 0,
					max: 100,
					splitNumber: 10,
					center: ['20%', '55%'],    // 默认全局居中
					radius: '50%',
					axisLine: {            // 坐标轴线
						lineStyle: {       // 属性lineStyle控制线条样式
							width: 10
						}
					},
					axisTick: {            // 坐标轴小标记
						length: 15,        // 属性length控制线长
						lineStyle: {       // 属性lineStyle控制线条样式
							color: 'auto'
						}
					},
					splitLine: {           // 分隔线
						length: 20,         // 属性length控制线长
						lineStyle: {       // 属性lineStyle（详见lineStyle）控制线条样式
							color: 'auto'
						}
					},
					axisLabel: {
						backgroundColor: 'auto',
						borderRadius: 2,
						color: '#eee',
						padding: 3,
						textShadowBlur: 2,
						textShadowOffsetX: 1,
						textShadowOffsetY: 1,
						textShadowColor: '#222'
					},
					title : {
						// 其余属性默认使用全局文本样式，详见TEXTSTYLE
						fontWeight: 'bolder',
						fontSize: 15,
						fontStyle: 'italic'
					},
					detail : {
						fontWeight: 'bolder',
						fontSize: 20,
					},
					data:[{value: 100, name: 'CPU'}]
				},
				{
					name: '内存',
					type: 'gauge',
					z: 3,
					min: 0,
					max: 100,
					splitNumber: 10,
					center: ['50%', '55%'],    // 默认全局居中
					radius: '50%',
					axisLine: {            // 坐标轴线
						lineStyle: {       // 属性lineStyle控制线条样式
							width: 10
						}
					},
					axisTick: {            // 坐标轴小标记
						length: 15,        // 属性length控制线长
						lineStyle: {       // 属性lineStyle控制线条样式
							color: 'auto'
						}
					},
					splitLine: {           // 分隔线
						length: 20,         // 属性length控制线长
						lineStyle: {       // 属性lineStyle（详见lineStyle）控制线条样式
							color: 'auto'
						}
					},
					axisLabel: {
						backgroundColor: 'auto',
						borderRadius: 2,
						color: '#eee',
						padding: 3,
						textShadowBlur: 2,
						textShadowOffsetX: 1,
						textShadowOffsetY: 1,
						textShadowColor: '#222'
					},
					title : {
						// 其余属性默认使用全局文本样式，详见TEXTSTYLE
						fontWeight: 'bolder',
						fontSize: 15,
						fontStyle: 'italic'
					},
					detail : {
						fontWeight: 'bolder',
						fontSize: 20,
					},
					data:[{value: 100, name: '内存'}]
				},
				{
					name: '磁盘',
					type: 'gauge',
					z: 3,
					min: 0,
					max: 100,
					splitNumber: 10,
					center: ['80%', '55%'],    // 默认全局居中
					radius: '50%',
					axisLine: {            // 坐标轴线
						lineStyle: {       // 属性lineStyle控制线条样式
							width: 10
						}
					},
					axisTick: {            // 坐标轴小标记
						length: 15,        // 属性length控制线长
						lineStyle: {       // 属性lineStyle控制线条样式
							color: 'auto'
						}
					},
					splitLine: {           // 分隔线
						length: 20,         // 属性length控制线长
						lineStyle: {       // 属性lineStyle（详见lineStyle）控制线条样式
							color: 'auto'
						}
					},
					axisLabel: {
						backgroundColor: 'auto',
						borderRadius: 2,
						color: '#eee',
						padding: 3,
						textShadowBlur: 2,
						textShadowOffsetX: 1,
						textShadowOffsetY: 1,
						textShadowColor: '#222'
					},
					title : {
						// 其余属性默认使用全局文本样式，详见TEXTSTYLE
						fontWeight: 'bolder',
						fontSize: 15,
						fontStyle: 'italic'
					},
					detail : {
						fontWeight: 'bolder',
						fontSize: 20,
					},
					data:[{value: 100, name: '磁盘'}]
				}
			]
		};

		//虚拟数据部分
		setInterval(function (){
			$.ajax({
				url: '{{ urlfor "KubePrometheusController.ProCpuMemDisk"}}',
				async: false,
				type: "get",
				data:{},
				success: function (data, status) {
					zxbk_cpu_men_disk_chart_option.series[0].data[0].value = parseFloat(data.cpu).toFixed(2);
					zxbk_cpu_men_disk_chart_option.series[1].data[0].value = parseFloat(data.mem).toFixed(2);
					zxbk_cpu_men_disk_chart_option.series[2].data[0].value = parseFloat(data.disk).toFixed(2);
				},
			});
			
			// 使用刚指定的配置项和数据显示图表。
			zxbk_cpu_men_disk_chart.setOption(zxbk_cpu_men_disk_chart_option,true);
		},2000);

        //zxbk_cpu_men_disk_chart 结束---------------------

		
		//main_public 开始---------------------
		var main_public = echarts.init(document.getElementById('main_public'));
		var main_public_data="";
		$.ajax({
			url: '{{ urlfor "KubePrometheusController.ProCount"}}',
			async: false,
			type: "get",
			data:{},
			success: function (data, status) {
				main_public_data=data;
				$('#podnum').text(main_public_data.podnum);
				$('#nodenum').text(main_public_data.nodenum);
				$('#netin').text((parseFloat(main_public_data.netin)/1024).toFixed(2));
				$('#netout').text((parseFloat(main_public_data.netout)/1024).toFixed(2));
			},
		});
		var COLOR = {
			MACHINE:{
				TYPE_A:'#0175EE',
				TYPE_B:'#D89446',
				TYPE_C:'#373693',
				TYPE_D:'#25AE4F',
				TYPE_E:'#06B5C6',
				TYPE_F:'#009E9A',
				TYPE_G:'#AC266F'
			}
		};
		main_public_option = {
			title : {
				//text: '应用运行状态',
				subtext: '服务比例',
				x:'center'
			},
			tooltip : {
				trigger: 'item',
				formatter: "{a} <br/>{b} : {c} ({d}%)"
			},
			legend: {
				orient: 'vertical',
				x: 'left',
				//y : 'center',
				data: ['Deployments: '+main_public_data.deployment,'Statefulset: '+main_public_data.statefulset,'Daemonset: '+main_public_data.daemonset,'Cronjob: '+main_public_data.cronjob]
			},
			color:[COLOR.MACHINE.TYPE_A,COLOR.MACHINE.TYPE_B,COLOR.MACHINE.TYPE_C,COLOR.MACHINE.TYPE_D],
			series : [
				{
					name: '访问来源',
					type: 'pie',
					radius : '55%',
					center: ['50%', '55%'],
					data:[
						{value:main_public_data.deployment, name:'Deployments: '+main_public_data.deployment},
						{value:main_public_data.statefulset, name:'Statefulset: '+main_public_data.statefulset},
						{value:main_public_data.daemonset, name:'Daemonset: '+main_public_data.daemonset},
						{value:main_public_data.cronjob, name:'Cronjob: '+main_public_data.cronjob},
					],
					itemStyle: {
						emphasis: {
							shadowBlur: 10,
							shadowOffsetX: 0,
							shadowColor: 'rgba(0, 0, 0, 0.5)'
						}
					}
				}
			]
		};
		
		main_public.setOption(main_public_option);

</script>
<!-- 加载图表显示结束 -->
	

    <!-- 页面内容结束 -->
</section>
<!-- /.content -->
